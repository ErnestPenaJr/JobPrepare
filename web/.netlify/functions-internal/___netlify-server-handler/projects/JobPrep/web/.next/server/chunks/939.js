"use strict";exports.id=939,exports.ids=[798,939],exports.modules={28939:(a,b,c)=>{c.r(b),c.d(b,{canConsumeAnalyze:()=>k,canConsumeCoverLetter:()=>m,getLimits:()=>j,loadUsage:()=>h,recordAnalyze:()=>l,recordCoverLetter:()=>n,saveUsage:()=>i});var d=c(76846);let e=null;try{e=c(96798)}catch{}function f(){return new Date().toISOString().slice(0,10)}function g(){return new Date().toISOString().slice(0,7)}async function h(a){if(e&&e.prisma){let b=f(),c=g(),d=await e.prisma.usage.findFirst({where:{sid:a}}).catch(()=>null);if(d){let e={sid:a,tier:d.tier||"free",day:d.day,month:d.month,analysesToday:d.analysesToday,analysesMonth:d.analysesMonth,coverLettersMonth:d.coverLettersMonth,updated_at:new Date().toISOString()};return e.day!==b&&(e.analysesToday=0,e.day=b),e.month!==c&&(e.analysesMonth=0,e.coverLettersMonth=0,e.month=c),e}let h={sid:a,tier:"free",day:b,month:c,analysesToday:0,analysesMonth:0,coverLettersMonth:0,updated_at:new Date().toISOString()};return await e.prisma.usage.create({data:{sid:a,day:h.day,month:h.month,analysesToday:0,analysesMonth:0,coverLettersMonth:0,tier:h.tier,sid:a}}).catch(()=>{}),h}globalThis.__usage=globalThis.__usage||{};let b=globalThis.__usage[a]||{sid:a,tier:"free",day:f(),month:g(),analysesToday:0,analysesMonth:0,coverLettersMonth:0,updated_at:new Date().toISOString()};return globalThis.__usage[a]=b,b}async function i(a){if(a.updated_at=new Date().toISOString(),e&&e.prisma){let b=await e.prisma.usage.findFirst({where:{sid:a.sid}});b?await e.prisma.usage.update({where:{id:b.id},data:{day:a.day,month:a.month,analysesToday:a.analysesToday,analysesMonth:a.analysesMonth,coverLettersMonth:a.coverLettersMonth,tier:a.tier}}):await e.prisma.usage.create({data:{sid:a.sid,day:a.day,month:a.month,analysesToday:a.analysesToday,analysesMonth:a.analysesMonth,coverLettersMonth:a.coverLettersMonth,tier:a.tier}});return}globalThis.__usage=globalThis.__usage||{},globalThis.__usage[a.sid]=a}function j(a){return(d.b.tiers.find(b=>b.id===a)||d.b.tiers[0]).limits}async function k(a,b="free"){let c=await h(a);c.tier=b;let d=j(b);return"number"==typeof d.analysesPerMonth&&c.analysesMonth>=d.analysesPerMonth?{ok:!1,reason:`Monthly analysis limit reached (${d.analysesPerMonth}/month)`,usage:c}:{ok:!0,usage:c}}async function l(a){a.analysesToday+=1,a.analysesMonth+=1,await i(a)}async function m(a,b="free"){let c=await h(a);c.tier=b;let d=j(b);return d.coverLettersPerMonth&&0!==d.coverLettersPerMonth?"number"==typeof d.coverLettersPerMonth&&c.coverLettersMonth>=d.coverLettersPerMonth?{ok:!1,reason:`Cover letter limit reached (${d.coverLettersPerMonth}/month)`,usage:c}:{ok:!0,usage:c}:{ok:!1,reason:"Cover letter generation requires Starter tier or higher.",usage:c}}async function n(a){a.coverLettersMonth+=1,await i(a)}},76846:(a,b,c)=>{c.d(b,{b:()=>e,r:()=>f});let d={starterMonthly:process.env.NEXT_PUBLIC_PRICE_STARTER_MONTHLY,starterYearly:process.env.NEXT_PUBLIC_PRICE_STARTER_YEARLY,proMonthly:process.env.NEXT_PUBLIC_PRICE_PRO_MONTHLY,proYearly:process.env.NEXT_PUBLIC_PRICE_PRO_YEARLY,careerMonthly:process.env.NEXT_PUBLIC_PRICE_CAREER_MONTHLY,careerYearly:process.env.NEXT_PUBLIC_PRICE_CAREER_YEARLY},e={tiers:[{id:"free",name:"Free",monthlyPrice:0,yearlyPrice:0,tagline:"Try the core analyzer",features:["Unlimited analyses","Score + basic gaps","View results only"],limits:{coverLettersPerMonth:0,storageMB:0,resumeProfiles:1,saveLimit:0}},{id:"starter",name:"Starter",monthlyPrice:9.99,yearlyPrice:89,tagline:"For active job seekers",features:["50 analyses / month","10 cover letters / month","Export + save history"],limits:{analysesPerMonth:50,coverLettersPerMonth:10,storageMB:100,resumeProfiles:1,saveLimit:20},trialDays:7,cardRequired:!1,stripe:{monthlyPriceId:d.starterMonthly,yearlyPriceId:d.starterYearly}},{id:"pro",name:"Pro",monthlyPrice:24.99,yearlyPrice:199,tagline:"Most popular â€” unlimited",features:["Unlimited analyses","Unlimited cover letters","Advanced insights + tracker"],limits:{analysesPerMonth:"unlimited",coverLettersPerMonth:"unlimited",storageMB:1024,resumeProfiles:1,saveLimit:"unlimited"},highlight:!0,trialDays:7,cardRequired:!1,stripe:{monthlyPriceId:d.proMonthly,yearlyPriceId:d.proYearly}},{id:"career",name:"Career",monthlyPrice:49.99,yearlyPrice:399,tagline:"Power users & coaches",features:["Unlimited everything","5 resume profiles","Priority support"],limits:{analysesPerMonth:"unlimited",coverLettersPerMonth:"unlimited",storageMB:10240,resumeProfiles:5,saveLimit:"unlimited"},trialDays:7,cardRequired:!1,stripe:{monthlyPriceId:d.careerMonthly,yearlyPriceId:d.careerYearly}}],promotions:{newYearBoost:!1,springExtendedTrial:!1,blackFridayAnnualDiscount:!1}};function f(a){return a&&e.promotions?.springExtendedTrial?Math.max(a,14):a}},96798:(a,b,c)=>{c.r(b),c.d(b,{prisma:()=>e});var d=c(96330);let e=global.prisma??new d.PrismaClient}};